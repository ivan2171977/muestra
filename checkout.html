<!DOCTYPE html>
<html lang="es">
<head>
<link rel="icon" type="image/png" href="img/favicon.png">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Checkout — Colegio Albania</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
  :root{ --brand:#0b3a74; --accent:#f4c20d; }
  body{ background:#f5f7fb; }
  .navbar{ background:var(--brand) !important; }
  .navbar .nav-link, .navbar .navbar-brand{ color:#fff !important; }
  .navbar .nav-link:hover{ color:var(--accent) !important; }
  .logo-img{ height:40px; width:auto; }
  .price{ color:#198754; font-weight:600; }
  .cart-badge{ position:absolute; top:-6px; right:-8px; background:var(--accent); color:#111; border-radius:999px; font-weight:700; font-size:11px; padding:2px 6px; display:none; }
</style>
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-dark sticky-top">
  <div class="container">
    <a class="navbar-brand" href="catalogo_coalba.html#top">
      <img src="img/LogoColegioAlbania-1024x358.png" class="logo-img" alt="Colegio Albania">
    </a>
    <ul class="navbar-nav ms-auto align-items-center gap-2">
      <li class="nav-item"><a class="nav-link" href="catalogo_coalba.html#top">Inicio</a></li>
      <li class="nav-item">
        <a class="nav-link position-relative" href="checkout.html">
          <img src="img/cart.png" style="height:22px;filter: brightness(0) invert(1);">
          <span id="cartCount" class="cart-badge">0</span>
        </a>
      </li>
    </ul>
  </div>
</nav>

<main class="container py-4">
  <h1 class="h4 mb-3">Resumen de compra</h1>
  <div class="row g-4">
    <div class="col-lg-8">
      <div class="card shadow-sm">
        <div class="table-responsive">
          <table class="table table-striped align-middle mb-0">
            <thead>
              <tr><th>Producto</th><th class="text-center">Talla</th><th class="text-center">Cantidad</th><th class="text-end">Precio</th><th class="text-end">Subtotal</th><th></th></tr>
            </thead>
            <tbody id="cartBody"></tbody>
          </table>
        </div>
        <div class="p-3 border-top d-flex justify-content-between">
          <strong>Total:</strong> <strong id="cartTotal">$0</strong>
        </div>
      </div>
    </div>
    <div class="col-lg-4">
      <div class="card shadow-sm p-3">
        <h2 class="h6">Pago por transferencia</h2>
        <p class="text-muted small mb-2">Ingresa tus datos y confirma para recibir las instrucciones de transferencia.</p>
        <div class="mb-2"><input class="form-control" placeholder="Nombre completo"></div>
        <div class="mb-2"><input class="form-control" placeholder="Correo"></div>
        <div class="mb-2"><input class="form-control" placeholder="Teléfono"></div>
        <button class="btn btn-primary w-100" id="payBtn">Pagar</button>
        <button class="btn btn-outline-danger w-100 mt-2" onclick="clearCart()">Vaciar carrito</button>
      </div>
    </div>
  </div>
</main>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="common.js"></script>
<script>
  function renderCart(){
    const tbody = document.getElementById('cartBody');
    const totalEl = document.getElementById('cartTotal');
    const cart = getCart();
    if (cart.length === 0){
      tbody.innerHTML = '<tr><td colspan="6" class="text-center text-muted py-4">Tu carrito está vacío.</td></tr>';
      totalEl.textContent = formatPrice(0);
      updateCartBadge();
      return;
    }
    tbody.innerHTML = cart.map(it => `
      <tr>
        <td><div class="d-flex align-items-center gap-2">
              <img src="img/${it.img}" alt="" style="width:48px;height:48px;object-fit:cover;border:1px solid #ddd;border-radius:6px;">
              <div>${it.name}<div class="text-muted small">${it.sku}</div></div>
            </div></td>
        <td class="text-center">${it.talla||'—'}</td>
        <td class="text-center">${it.qty}</td>
        <td class="text-end">${formatPrice(it.price)} COP</td>
        <td class="text-end">${formatPrice(it.price*it.qty)} COP</td>
        <td class="text-end"><button class="btn btn-sm btn-outline-danger" onclick="removeFromCart('${it.sku}')">Quitar</button></td>
      </tr>
    `).join('');
    const total = cart.reduce((s,i)=>s+i.price*i.qty,0);
    totalEl.textContent = formatPrice(total) + ' COP';
    updateCartBadge();
  }
  window.renderCart = renderCart;
  renderCart();

  document.getElementById('payBtn').addEventListener('click', () => {
    if (getCart().length === 0){ alert('Tu carrito está vacío.'); return; }
    const order = placeOrder({});
    if(order){ alert('Pedido creado: ' + order.id + '. Te enviaremos instrucciones de transferencia.'); renderCart(); }
  });
</script>
</body>
</html>
